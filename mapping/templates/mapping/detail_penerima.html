{% extends 'base.html' %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'mapping/leaflet/routing/dist/leaflet-routing-machine.css' %}" />
<script src="{% static 'mapping/leaflet/routing/dist/leaflet-routing-machine.js' %}"></script>
{% endblock head %}

{% block body %}
<div class="content-body" style="min-height: 788px">
    <div class="row page-titles mx-0">
      <div class="col p-md-0">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <a href="{% url 'dashboard' %}">Dashboard</a>
          </li>
          <li class="breadcrumb-item active">
            <a href="{% url 'mapping:penerima' slug=penerima.bansos.slug %}">Penerima Bansos</a>
          </li>
          <li class="breadcrumb-item active">
            <a href="{% url 'mapping:detail' id=penerima.id %}">Detail</a>
          </li>
        </ol>
      </div>
    </div>
    <!-- row -->
  
    <div class="container-fluid">
        <div class="alert alert-success" role="alert">
            Anggota ini telah menerima sebanyak 3 kali <a href="#" class="alert-link">Bantuan Sosial Sembako Lansia</a>.
        </div>
      <div class="row">
        <div class="col-12">
          <div class="card">
            <div class="card-body">
                <h4 class="card-title mb-4">Detail Data Penerima</h4>  
                <div class="basic-form">
                    <form>
                        <div class="form-group row mb-2 mt-0">
                            <label class="col-sm-2 col-form-label">Nama</label>
                            <h6 class="col-sm-6 col-form-label"><b>{{penerima.anggota}}</b></h6>
                        </div>
                        <div class="form-group row mb-2 mt-0">
                            <label class="col-sm-2 col-form-label">Alamat</label>
                            <h6 class="col-sm-6 col-form-label"><b>{{penerima.anggota.rumah.alamat}}</b></h6>
                        </div>
                        <div class="form-group row mb-2 mt-0">
                            <label class="col-sm-2 col-form-label">Bukti Menerima</label>
                            <img src="/media/{{penerima.foto_bukti}}" class="col-sm-2 col-form-label" alt="" width="300px">
                        </div>
                    </form>
                </div>
            </div>
          </div>
          <div class="card">
            <div class="card-body">
                <h4 class="card-title mb-4">Route</h4>      
                <div class="row mb-2 mt-0">
                    <div class="col">
                        <div id="map" style="width:100%; height:550px"></div>
                    </div>
                </div>
            </div>
          </div>
          <div class="card">
            <div class="card-body">
                <h4 class="card-title mb-4">Bukti Menerima</h4>      
                <div class="row mb-2 mt-0">
                    <div class="col">
                        
                    </div>
                </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- #/ container -->
  </div>
{% endblock body %}

{% block footer %}
<script>
    
    var map = L.map('map').setView([{{penerima.anggota.rumah.koordinat_lat}}, {{penerima.anggota.rumah.koordinat_long}}], 12);

    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    navigator.geolocation.getCurrentPosition(function(position) {
        L.Routing.control({
            waypoints: [
            L.latLng(position.coords.latitude, position.coords.longitude),
            L.latLng({{penerima.anggota.rumah.koordinat_lat}}, {{penerima.anggota.rumah.koordinat_long}})
            ]
        }).addTo(map);
    });

      {% comment %} navigator.geolocation.getCurrentPosition(function(location) {
        var latlng = new L.LatLng(location.coords.latitude, location.coords.longitude);
      
        var mymap = L.map('mapid').setView(latlng, 13)
        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
          attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://mapbox.com">Mapbox</a>',
          maxZoom: 18,
          id: 'mapbox.streets',
          accessToken: 'pk.eyJ1IjoiYmJyb29rMTU0IiwiYSI6ImNpcXN3dnJrdDAwMGNmd250bjhvZXpnbWsifQ.Nf9Zkfchos577IanoKMoYQ'
        }).addTo(mymap);
      
        var marker = L.marker(latlng).addTo(mymap);
      }); {% endcomment %}

  </script>
{% endblock footer %}